!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).markdownitDollarmath=t()}(this,(function(){"use strict";const e={allow_space:!0,allow_digits:!0,double_inline:!0,allow_labels:!0,labelNormalizer:e=>e.replace(/[\s]+/g,"-")};function t(e,t,n=0){let r=0;for(;t>=0&&(t-=1,92===e.src.charCodeAt(t));)r+=1;return 0!==r&&r%2!==n}function n(e,t){const n=e.split("").reverse().join("").match(/^\s*\)(?<label>[^)$\r\n]+?)\(\s*\${2}/);if(n&&n.groups){return{label:n.groups.label.split("").reverse().join(""),end:t-=(n.index||0)+n[0].length}}return{end:t}}return function(r,l){const i=Object.assign(Object.assign({},e),l);r.inline.ruler.before("escape","math_inline",function(e){function n(n,r){if(36!==n.src.charCodeAt(n.pos))return!1;if(!e.allow_space&&n.md.utils.isWhiteSpace(n.src.charCodeAt(n.pos+1)))return!1;if(!e.allow_digits){const e=n.src.charAt(n.pos-1);if(e&&""!==e.trim()&&!isNaN(Number(e)))return!1}if(t(n,n.pos))return!1;let l=!1;e.double_inline&&36===n.src.charCodeAt(n.pos+1)&&(l=!0);let i=n.pos+1+(l?1:0),s=!1,o=-1;for(;!s;){if(o=n.src.indexOf("$",i),-1===o)return!1;t(n,o)?i=o+1:l&&36!==n.src.charCodeAt(o+1)?i=o+1:(l&&(o+=1),s=!0)}if(!s)return!1;if(!e.allow_space){const e=n.src.charCodeAt(o-1);if(n.md.utils.isWhiteSpace(e))return!1}if(!e.allow_digits){const e=n.src.charAt(o+1);if(e&&""!==e.trim()&&!isNaN(Number(e)))return!1}let c=n.src.slice(n.pos+1,o);if(l&&(c=n.src.slice(n.pos+2,o-1)),!c)return!1;if(!r){const e=n.push(l?"math_inline_double":"math_inline","math",0);e.content=c,e.markup=l?"$$":"$"}return n.pos=o+1,!0}return n}(i)),r.block.ruler.before("fence","math_block",function(e){function t(t,r,l,i){let s=!1;const o=t.bMarks[r]+t.tShift[r];let c=t.eMarks[r];if(t.sCount[r]-t.blkIndent>=4)return!1;if(o+2>c)return!1;if(36!=t.src.charCodeAt(o)||36!=t.src.charCodeAt(o+1))return!1;let a,u,f=r,d=t.src.slice(o,c);if(d.trim().length>3)if(d.trim().endsWith("$$"))s=!0,c=c-2-(d.length-d.trim().length);else if(e.allow_labels){const e=n(d,c);void 0!==e.label&&(s=!0,a=e.label,c=e.end)}if(!s)for(;f+1<l;)if(f+=1,u=t.bMarks[f]+t.tShift[f],c=t.eMarks[f],!(c-u<2)){if(d=t.src.slice(u,c),d.trim().endsWith("$$")){s=!0,c=c-2-(d.length-d.trim().length);break}if(e.allow_labels){const e=n(d,c);if(void 0!==e.label){s=!0,a=e.label,c=e.end;break}}}if(!s)return!1;t.line=f+(s?1:0);const h=t.push(a?"math_block_label":"math_block","math",0);return h.block=!0,h.content=t.src.slice(o+2,c),h.markup="$$",h.map=[r,t.line],a&&(h.info=e.labelNormalizer?e.labelNormalizer(a):a),!0}return t}(i));const s=null==i?void 0:i.renderer;s?(r.renderer.rules.math_inline=(e,t)=>{const n=e[t].content;let l;try{l=s(n,null==i?void 0:i.optionsInline)}catch(e){l=r.utils.escapeHtml(`${n}:${e.message}`)}return l},r.renderer.rules.math_inline_double=(e,t)=>{const n=e[t].content;let l;try{l=s(n,null==i?void 0:i.optionsBlock)}catch(e){l=r.utils.escapeHtml(`${n}:${e.message}`)}return l},r.renderer.rules.math_block=(e,t)=>{const n=e[t].content;let l;try{l=s(n,null==i?void 0:i.optionsBlock)}catch(e){l=r.utils.escapeHtml(`${n}:${e.message}`)}return l},r.renderer.rules.math_block_label=(e,t)=>{const n=e[t].content,l=e[t].info;let o;try{o=s(n,null==i?void 0:i.optionsBlock)}catch(e){o=r.utils.escapeHtml(`${n}:${e.message}`)}return o+`\n<a href="#${l}" class="mathlabel" title="Permalink to this equation">Â¶</a>\n`}):(r.renderer.rules.math_inline=(e,t)=>`<eq>${e[t].content}</eq>`,r.renderer.rules.math_inline_double=(e,t)=>`<eqn>${e[t].content}</eqn>`,r.renderer.rules.math_block=(e,t)=>`<section>\n<eqn>${e[t].content}</eqn>\n</section>\n`,r.renderer.rules.math_block_label=(e,t)=>`<section>\n<eqn>${e[t].content}</eqn>\n<span class="eqno">(${e[t].info})</span>\n</section>\n`)}}));
//# sourceMappingURL=index.js.map
